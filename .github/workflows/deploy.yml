name: 🚀 Deploy to Server

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: 📥 Checkout del código
        uses: actions/checkout@v3

      - name: 🚀 Desplegar en servidor
        run: |
          ssh -v -o StrictHostKeyChecking=no root@tl-showroom.equalitech.xyz << 'EOF'
            mkdir -p /opt/frontend/showroom-frontend
            cd /opt/frontend/showroom-frontend

            if [ ! -d ".git" ]; then
              echo "⚠️ Repo no clonado, clonando ahora..."
              git clone git@github.com:jupahefi/.git .
            fi

            git pull origin main
            bash deploy.sh
          EOF
